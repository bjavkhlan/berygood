(function(){"use strict";angular.module("berygoodApp",["ngRoute"]);t.$inject=["$routeProvider"];function t(t){t.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"about/about.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/why",{templateUrl:"common/views/genericText.view.html",controller:"whyCtrl",controllerAs:"vm"}).when("/selection",{templateUrl:"selection/selection.view.html",controller:"selectionCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}var e={};if(window){Object.assign(e,window.__env)}angular.module("berygoodApp").config(["$routeProvider",t]).constant("__env",e)})();(function(){"use strict";angular.module("berygoodApp").controller("homeCtrl",t);t.$inject=["$scope","transdepData","$sce","$window","$timeout"];function t(t,e,n,o,r){var i=this;var a=new google.maps.DirectionsService;var u=new google.maps.DirectionsRenderer;var l="/images/pin.png";e.getRoutes().then(function(t){i.routes=t.data;i.parseData()}).catch(function(t){console.log(t)});i.parseData=function(){i.departures=[];for(var t=0;t<i.routes.length;t++)for(var e=0;e<i.routes[t].departures.length;e++){i.departures.push({origin:i.routes[t].origin.name,destination:i.routes[t].destination.name,date:i.routes[t].departures[e].date,bus:i.routes[t].departures[e].bus,routeIdx:t})}i.search(0)};i.search=function(t){i.route=i.routes[i.departures[t].routeIdx];i.route.date=i.departures[t].date;i.route.bus=i.departures[t].bus;e.getBusLocation(i.departures[t].bus.licenseNumber).then(function(t){i.busLoc=t.data;i.getRemainingTime();i.calculateAndDisplayRoute()}).catch(function(t){i.searchMessage="Хайлт олдсонгүй";console.log(err)})};i.getRemainingTime=function(){i.remaining={};var t={origin:i.busLoc.lat+", "+i.busLoc.lng,destination:i.route.destination.lat+", "+i.route.destination.lng,travelMode:"DRIVING"};a.route(t,function(t,e){if(e==="OK"){i.remaining.duration=t.routes[0].legs[0].duration.value;i.remaining.distance=t.routes[0].legs[0].distance.value}else{window.alert("Directions request failed due to "+e)}});i.elapsed={};var t={origin:i.route.origin.lat+", "+i.route.origin.lng,destination:i.busLoc.lat+", "+i.busLoc.lng,travelMode:"DRIVING"};a.route(t,function(t,e){if(e==="OK"){i.elapsed.duration=(Date.parse(new Date)-Date.parse(i.route.date))/1e3;i.elapsed.distance=t.routes[0].legs[0].distance.value}else{window.alert("Directions request failed due to "+e)}});r(function(){},300)};i.calculateAndDisplayRoute=function(){i.busMarker=new google.maps.Marker({position:i.busLoc,map:i.map,title:"Автобус",animation:google.maps.Animation.DROP,label:"Bus"});var e={origin:i.route.origin.lat+", "+i.route.origin.lng,destination:i.route.destination.lat+", "+i.route.destination.lng,travelMode:"DRIVING",waypoints:[]};i.route.waypoints.forEach(function(t){e.waypoints.push({location:t.lat+", "+t.lng,stopover:true})});a.route(e,function(t,e){if(e==="OK"){u.setDirections(t)}else{window.alert("Directions request failed due to "+e)}})};o.initMap=function(){i.map=new google.maps.Map(document.getElementById("map"),{});u.setMap(i.map)};o.initMap()}})();(function(){angular.module("busLocApp").controller("aboutCtrl",t);t.$inject=["$sce"];function t(t){var e=this}})();(function(){angular.module("busLocApp").controller("whyCtrl",t);t.$inject=["$sce"];function t(t){var e=this;e.main={title:"Энэ web application-ийг яагаад үүсгэх болсон бэ?",content:"Хот хоорондын зорчигч тээврээр үйлчлүүлж байгаа хүмүүсийг очих газар нь хүлээн авах хүмүүс тосож авах цагаа тааруулахын тулд байн байн залгаж хаана явааг нь асуудаг. Тэгвэл энэ web application нь хүлээн авах хүн тухайн зорчигчийн зорчиж буй чиглэл, хөдлөсөн цаг огноо, зорчиж буй тээврийн хэрэгслийн жолооч ба улсын дугаар гэсэн мэдээлэл дээр тулгуурлан интернетэд холбогдон тухайн зорчиж буй тээврийн хэрэгслийн байршил болон зорьсон газраа очих хугацааг ойролцоогоор мэдэх боломжийг олгоно."};e.main.title=t.trustAsHtml(e.main.title);e.main.content=t.trustAsHtml(e.main.content)}})();(function(){"use strict";angular.module("busLocApp").controller("routeCtrl",t);t.$inject=["$scope","transdepData"];function t(t,e){var n=this;e.getStations().then(function(t){n.stations=t.data}).catch(function(t){console.log(t)});e.getRoutes().then(function(t){n.routes=t.data}).catch(function(t){console.log(t)})}})();(function(){angular.module("busLocApp").directive("navigation",t);function t(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("busLocApp").directive("timeline",t);function t(){return{restrict:"EA",scope:{elapsed:"=",remaining:"=",route:"="},templateUrl:"/common/directives/timeline/timeline.template.html"}}})();(function(){"use strict";angular.module("busLocApp").service("transdepData",t);t.$inject=["$http","__env"];function t(e,n){var t=this;t.getRoutes=function(){return e.get(n.routeApiUrl)};t.getBusLocation=function(t){return e.get(n.busApiUrl+t)}}})();(function(){"use strict";angular.module("busLocApp").filter("dateInMillis",t);function t(){return function(t){return Date.parse(t)}}})();(function(){"use strict";angular.module("busLocApp").filter("dateInHour",t);function t(){return function(t){var e="";e+=Math.floor(t/3600)+" цаг";if(Math.floor((t-3600*Math.floor(t/3600))/900))e+=" "+Math.floor((t-3600*Math.floor(t/3600))/900)*15+" минут";return e}}})();(function(){angular.module("busLocApp").filter("addHtmlLineBreaks",t);function t(){return function(t){var e=String(t).replace(/\n/g,"<br/>");return e}}})();(function(){"use strict";angular.module("busLocApp").filter("distanceInKm",t);function t(){return function(t){var e="";e+=Math.floor(t/100)/10+" км";return e}}})();
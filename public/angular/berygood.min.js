(function(){"use strict";angular.module("berygoodApp",["ngRoute"]);e.$inject=["$routeProvider"];function e(e){e.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"about/about.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/why",{templateUrl:"common/views/genericText.view.html",controller:"whyCtrl",controllerAs:"vm"}).when("/selection",{templateUrl:"selection/selection.view.html",controller:"selectionCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}var t={};if(window){Object.assign(t,window.__env)}angular.module("berygoodApp").config(["$routeProvider",e]).constant("__env",t)})();(function(){"use strict";angular.module("berygoodApp").controller("homeCtrl",e);e.$inject=[];function e(){}})();(function(){angular.module("berygoodApp").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var n=this;n.pageHeader={title:"Create a new Berygood account"};n.credentials={id:"",password:""};n.returnPage=e.search().page||"/";n.onSubmit=function(){n.formError="";if(!n.credentials.id||!n.credentials.password){n.formError="All fields required, please try again";return false}else{n.doRegister()}};n.doRegister=function(){n.formError="";t.register(n.credentials).error(function(e){n.formError=e}).then(function(){e.search("page",null);e.path(n.returnPage)})}}})();angular.module("berygoodApp").controller("loginCtrl",loginCtrl);loginCtrl.$inject=["$location","authentication"];function loginCtrl(e,t){var n=this;n.pageHeader={title:"Sign in to Loc8r"};n.credentials={id:"",password:""};n.returnPage=e.search().page||"/";n.onSubmit=function(){n.formError="";if(!n.credentials.id||!n.credentials.password){n.formError="All fields required, please try again";return false}else{n.doLogin()}};n.doLogin=function(){n.formError="";t.login(n.credentials).error(function(e){n.formError=e}).then(function(){e.search("page",null);e.path(n.returnPage)})}}(function(){"use strict";angular.module("berygoodApp").controller("selectionCtrl",e);e.$inject=["$scope","$route","dataProvider","authentication"];function e(e,t,n,o){var r=this;r.selected=[];r.lessons=[];r.id=o.currentUser().id;n.getStudentById(r.id).then(function(e){r.student=e.data;console.log("student",r.student);n.getCurByIndex(r.student.curriculum).then(function(e){r.curriculum=e.data;console.log("curriculum",r.curriculum);n.getLessons().then(function(e){for(var t=0;t<e.data.length;t++)if(r.curriculum.lessons.includes(e.data[t].index))r.lessons.push(e.data[t])}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)});n.getSelection(r.id).then(function(e){for(var t=0;t<e.data.length;t++)r.selected.push(e.data[t]);console.log("selection",r.selected)}).catch(function(e){console.log(e)});r.isSelected=function(e){for(var t=0;t<r.selected.length;t++)if(r.selected[t].lesson===e)return r.selected[t];return false};r.selectLesson=function(t){n.getTeachers(t).then(function(e){r.teachers=e.data;r.selectedLesson=t;console.log("teacher",e.data)}).catch(function(e){console.log(e)})};r.selectTeacher=function(e){r.teachers=undefined;n.postSelection({student:r.id,lesson:r.selectedLesson,teacher:e}).then(function(e){console.log(e);t.reload()}).catch(function(e){console.log(e)})};r.deleteSelection=function(e){n.deleteSelection({student:r.id,lesson:e}).then(function(e){console.log(e);t.reload()}).catch(function(e){console.log(e)})}}})();(function(){angular.module("berygoodApp").controller("aboutCtrl",e);e.$inject=["$sce"];function e(e){var t=this}})();(function(){angular.module("berygoodApp").controller("whyCtrl",e);e.$inject=["$sce"];function e(e){var t=this;t.main={title:"Энэ web application-ийг яагаад үүсгэх болсон бэ?",content:"Хот хоорондын зорчигч тээврээр үйлчлүүлж байгаа хүмүүсийг очих газар нь хүлээн авах хүмүүс тосож авах цагаа тааруулахын тулд байн байн залгаж хаана явааг нь асуудаг. Тэгвэл энэ web application нь хүлээн авах хүн тухайн зорчигчийн зорчиж буй чиглэл, хөдлөсөн цаг огноо, зорчиж буй тээврийн хэрэгслийн жолооч ба улсын дугаар гэсэн мэдээлэл дээр тулгуурлан интернетэд холбогдон тухайн зорчиж буй тээврийн хэрэгслийн байршил болон зорьсон газраа очих хугацааг ойролцоогоор мэдэх боломжийг олгоно."};t.main.title=e.trustAsHtml(t.main.title);t.main.content=e.trustAsHtml(t.main.content)}})();(function(){angular.module("berygoodApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}})();(function(){angular.module("berygoodApp").controller("navigationCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var n=this;n.currentPath=e.path();n.isLoggedIn=t.isLoggedIn();n.currentUser=t.currentUser();n.logout=function(){t.logout();e.path("/")}}})();(function(){"use strict";angular.module("berygoodApp").service("dataProvider",e);e.$inject=["$http"];function e(t){var e=this;e.getLessons=function(){return t.get("/api/lessons")};e.getStudentById=function(e){return t.get("/api/students/"+e)};e.getCurByIndex=function(e){return t.get("/api/curriculums/"+e)};e.postSelection=function(e){return t.post("/api/selection",e)};e.deleteSelection=function(e){return t.delete("/api/selection/"+e.student+"/"+e.lesson)};e.getSelection=function(e){return t.get("/api/selection/"+e)};e.getTeachers=function(e){return t.get("/api/teachers/"+e)}}})();(function(){"use strict";angular.module("berygoodApp").service("authentication",e);e.$inject=["$window","$http"];function e(n,t){var o=this;o.getToken=function(){return n.localStorage["berygood-token"]};o.saveToken=function(e){n.localStorage["berygood-token"]=e};o.register=function(e){return t.post("/api/register",e).success(function(e){o.saveToken(e.token)})};o.login=function(e){return t.post("/api/login",e).success(function(e){o.saveToken(e.token)})};o.logout=function(){n.localStorage.removeItem("berygood-token")};o.isLoggedIn=function(){var e=o.getToken();if(e){var t=JSON.parse(n.atob(e.split(".")[1]));return t.exp>Date.now()/1e3}else{return false}};o.currentUser=function(){if(o.isLoggedIn()){var e=o.getToken();var t=JSON.parse(n.atob(e.split(".")[1]));return{id:t.id}}}}})();